# 命理分析小程序 MVP 产品需求文档（PRD）

## 一、产品概述

本产品是一款基于中国传统命理学的微信小程序，用户通过输入阳历出生日期和出生时辰，一键获取农历日期、八字四柱、五行分布、五行缺失提示、生肖及简要命理解读，并可体验多维度的命理占卜服务。MVP版本聚焦于极简输入、核心命理输出、多维占卜和国风视觉体验。

## 二、目标用户
- 对命理学、八字、五行等传统文化感兴趣的用户
- 需要快速查询个人命理信息及运势占卜的普通用户
- 追求美观、简洁、易用体验的微信用户

## 三、核心功能

### 1. 首页引导
- 全屏水墨山水+明月背景，顶部大Logo"星命阁 · AstroSeed.X"
- 居中显示品牌与功能简介
- 绿色大按钮"开始计算"居中，极简风格

### 2. 信息输入页
- 背景同首页，内容区块为半透明/白色卡片，居中显示
- 输入项：
  - 出生日期（阳历，日期选择器，支持1900-2100年，右侧">"图标）
  - 出生时辰（12时辰制，右侧">"图标）
- 按钮"开始计算"居中，绿色主色调，未填写完整时置灰禁用

### 3. 结果页
- 背景同首页，内容区块为半透明卡片，居中显示
- **重要：背景图片需采用特殊布局以确保覆盖所有内容，即使结果页内容较长时也能展示完整背景**
- 展示：
  - 用户性别、出生时间
  - 农历日期
  - 八字四柱（年柱、月柱、日柱、时柱子）
  - 五行分布（横向分布，突出颜色）
  - 五行特性简析
  - 五行属性分布图（金木水火土比例）
  - 五行缺失提示（如"缺金，建议佩戴金属饰品"）
  - 生肖及命理简析（3-5句AI生成解读）
  - 绿色大按钮"继续占卜"
- 结果展示风格延续国风水墨，结构清晰
- **卡片背景需保持透明，不应遮挡背景图片**

### 4. 占卜入口页
- 背景同首页，内容区块为半透明卡片，居中显示
- 占卜类型列表（爱情、事业、今日建议、综合运势），每项为卡片/按钮，右侧">"图标
- 绿色大按钮"关闭"

### 5. 多维占卜功能（MVP核心）
- 占卜类型及功能说明：
  1. 爱情占卜
     - 桃花运指数（0-100分，雷达图展示）
     - 伴侣八字匹配（需双方输入，匹配度分析）
     - 情感问题建议（如"本月宜主动沟通"，AI生成，问答式表单）
  2. 事业占卜
     - 职业五行适配度（推荐行业，图表展示）
     - 年度事业趋势（折线图）
     - 跳槽/创业吉凶提示（关键词标签）
  3. 综合运势
     - 每日/每月健康、财运、情绪指数（日历视图）
     - 吉时提醒（如"9:00-11:00宜签约"，推送通知）
  4. 今日建议
     - 幸运颜色/方位/数字（卡片式瀑布流）
     - 禁忌行为（如"忌穿黑色"）
     - 饮食/穿搭建议（结合五行，卡片式展示）

### 6. 辅助功能（MVP可选/后续迭代）
- 历史记录：自动保存用户查询记录，支持对比分析（如"对比三年前运势"）
- 社交分享：生成运势海报（带生肖图标和运势关键词，可分享至朋友圈）
- 个性化报告：生成PDF命理书（付费解锁，含10页详细解读）

## 四、页面原型说明
- 所有页面主内容居中，分区清晰，按钮风格统一，极简国风
- 主要内容区块为半透明卡片，提升可读性
- 绿色为主色调，按钮、分区高亮
- 交互流程：
  1. 首页点击"开始"进入信息输入页
  2. 填写信息后进入结果页
  3. 结果页点击"继续占卜"进入占卜入口页
  4. 占卜入口页可选择不同占卜类型

## 五、交互流程
1. 用户进入首页，点击"开始"
2. 跳转至信息输入页，填写出生日期和时辰
3. 填写完整后，"计算"按钮高亮可点击
4. 点击"计算"，前端校验输入，用用户填入的信息调用后端DEESPSEEKAPI进行命理计算
5. 计算结果返回后，跳转至结果页或占卜功能页
6. 用户可切换不同占卜类型，查看AI分析与建议
7. （可选）用户可保存历史记录或生成分享海报

## 六、技术实现要点
- 前端：微信小程序原生开发，使用WXML+WXSS，国风UI设计
- 日期选择器、时辰选择器自定义组件，支持1900-2100年
- 占卜类型Tab、雷达图、折线图、日历、卡片流等可视化组件
- 输入校验：出生日期、时辰必填，未填完整禁用按钮
- 背景图实现：
  - 必须使用<image>标签而非CSS background-image（微信小程序限制）
  - 长内容页面需采用特殊结构确保背景图显示完整
  - 所有卡片必须保持背景透明以展示底层背景图
- 后端API：
  - 输入：出生日期、时辰、（如有，伴侣信息、占卜类型等）
  - 输出：农历日期、八字四柱、五行分布、五行缺失、生肖、AI解读、各类占卜结果
- AI解读调用DeepSeek API，返回3-5句简要命理分析及个性化占卜建议
  ```
  // DeepSeek API调用示例
  curl https://api.deepseek.com/chat/completions \
    -H "Content-Type: application/json" \
    -H "Authorization: Bearer sk-ab8914cd6dc84cbbbcff46c4efb018f6" \
    -d '{
          "model": "deepseek-chat",
          "messages": [
            {
              "role": "system", 
              "content": "你是一位专业的命理分析师，精通八字命理。请根据用户提供的出生日期和时辰进行命理分析，并以JSON格式返回结果。"
            },
            {
              "role": "user", 
              "content": "请根据以下出生信息进行八字命理分析：\n\n出生日期（阳历）：1995-08-15\n出生时辰：午时\n\n请提供以下分析结果：\n1. 农历日期\n2. 当时节气\n3. 生肖\n4. 八字四柱（年柱、月柱、日柱、时柱）\n5. 五行分布情况（金、木、水、火、土各自的强度，用1-3的数字表示）\n6. 五行是否有缺失，若有请指出\n7. 命理简析（包括性格特点、事业发展、财运分析、感情生活等方面，简要分析）\n\n请以JSON格式返回结果。"
            }
          ],
          "stream": false
        }'
  ```
- 历史记录、PDF报告、社交分享等功能可后续迭代

## 七、数据接口定义（MVP）
- 请求：
```json
{
  "birth_date": "1995-08-15",
  "birth_time": "午时",
  "divination_type": "love", // love/career/fortune/advice
  "partner_birth_date": "1996-01-01", // 仅爱情占卜时填写
  "partner_birth_time": "子时" // 仅爱情占卜时填写
}
```
- 响应：
```json
{
  "lunar_date": "1995年七月十九（闰月）",
  "solar_term": "立秋",
  "bazi": {
    "year": "乙亥",
    "month": "丙申",
    "day": "丁酉",
    "hour": "戊午"
  },
  "wuxing": {
    "金": 2,
    "木": 1,
    "水": 1,
    "火": 2,
    "土": 1
  },
  "wuxing_lack": "缺木，建议多接触大自然",
  "zodiac": "猪",
  "ai_summary": [
    "你天生聪慧，适合文职工作。",
    "今年事业有贵人相助。",
    "注意饮食健康，防止肠胃问题。"
  ],
  "divination": {
    "love": {
      "peach_blossom_score": 85,
      "match_score": 90,
      "advice": "本月宜主动沟通，感情升温。"
    },
    "career": {
      "industry_fit": ["教育", "金融"],
      "trend": [80, 85, 90, 88, 92],
      "change_advice": "今年适合稳中求进，跳槽需谨慎。"
    },
    "fortune": {
      "health": 80,
      "wealth": 75,
      "emotion": 90,
      "lucky_time": "9:00-11:00宜签约"
    },
    "advice": {
      "lucky_color": "绿色",
      "lucky_direction": "东南",
      "lucky_number": 6,
      "taboo": "忌穿黑色",
      "diet": "多食绿色蔬菜，提升运势"
    }
  }
}
```

## 八、测试要点
- 输入校验：日期、时辰必填，异常输入提示
- 交互流程：按钮状态切换、页面跳转流畅，Tab切换无卡顿
- 结果准确性：农历、八字、五行、占卜等计算正确
- 视觉一致性：国风水墨风格统一，按钮高亮、禁用状态明显
- 占卜结果可视化组件（雷达图、折线图、日历、卡片流）展示正常
- AI建议内容通顺、贴合用户输入

---

## 原型图与页面结构（MVP高保真草图）

### 1. 首页（Cover）
```
┌─────────────────────────────┐
│           （background.png）           │
│                             │
│     星命阁 · AstroSeed.X       │
│                             │
│   [开始]（绿色大按钮，居中）   │
└─────────────────────────────┘
```
- 背景：全屏background.png
- Logo/品牌名居中，按钮居中
- 按钮点击进入信息输入页

### 2. 信息输入页
```
┌─────────────────────────────┐
│           （background.png）           │
│ ┌─────────────────────┐ │
│ │ 请选择出生日期（阳历）   > │ │
│ │ 请选择出生时辰         > │ │
│ └─────────────────────┘ │
│   [计算]（绿色大按钮，居中）   │
└─────────────────────────────┘
```
- 内容区块为透明卡片，居中
- 输入项右侧有">"图标，点击弹出选择器
- 按钮未填写完整时置灰禁用

### 3. 结果页
```
┌─────────────────────────────┐
│           （background.png）           │
│ ┌─────────────────────┐ │
│ │ 性别：女  时间：2025-05-16 6:35 │
│ │ 农历日期：乙巳年 四月十九      │
│ │ 八字四柱：乙巳 辛巳 戊午 乙卯 │
│ │ 五行分布：木3 火4 土1 金1 水1  │
│ │ 五行分布图：[图表]             │
│ │ 五行缺失提示：缺金，建议佩戴金属饰品 │
│ │ 生肖及命理简析：...（3-5句AI解读） │
│ └─────────────────────┘ │
│   [继续占卜]（绿色大按钮，居中）   │
└─────────────────────────────┘
```
- 结果区块为透明卡片，内容分区清晰
- 结果展示风格延续国风水墨，结构清晰
- 按钮点击进入占卜入口页

### 4. 占卜入口页
```
┌─────────────────────────────┐
│           （background.png）           │
│ ┌─────────────────────┐ │
│ │ 爱情占卜   >                │ │
│ │ 事业占卜   >                │ │
│ │ 今日建议   >                │ │
│ │ 综合运势   >                │ │
│ └─────────────────────┘ │
│   [关闭]（绿色大按钮，居中）      │
└─────────────────────────────┘
```
- 占卜类型为卡片/按钮，右侧">"图标
- 按钮点击关闭或返回

---

**交互说明：**
- 所有页面都应使用同一个背景图（background.png）
- 主要内容区块为半透明卡片，提升可读性
- 绿色为主色调，按钮、分区高亮
- 输入未完整时按钮禁用，填写完整后高亮可点击
- 结果页和占卜入口页为卡片式分区，内容结构化
- 信息输入页的信息需要通过DEEPSEEK API调用DEEPSEEK获取结果，结果需展示在结果页
- 卡片内容较长时，背景图片需完全覆盖所有内容，不应出现白色背景

如需进一步补充页面细节或交互流程，请随时告知。 